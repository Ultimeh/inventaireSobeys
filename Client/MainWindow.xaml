<Window x:Name="mainWindow" x:Class="Client.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Client"
        mc:Ignorable="d"  
        Title="Inventaire Sobeys" Height="700" Width="1336" IsEnabled="{Binding enableMain}" HorizontalAlignment="Left" VerticalAlignment="Top" MinWidth="1100" MinHeight="600" WindowStyle="None" BorderThickness="1.45" BorderBrush="DimGray" WindowStartupLocation="CenterScreen" ResizeMode="CanResize" MouseLeftButtonDown="mainWindow_MouseLeftButtonDown" Closing="mainWindow_Closing">

    <Window.Style>
        <Style TargetType="{x:Type Window}">
            <Setter Property="Background" Value="#FFEEEEEE"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                    <Setter Property="Background" Value="#FF292929"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Window.Style>

    <Grid>
        <Label Margin="190,0,108,0" Height="30" VerticalAlignment="Top" MouseDoubleClick="Label_MouseDoubleClick" />

        <DockPanel Width="auto" Height="20" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="6,6,0,0" >
            <Menu x:Name="topMenu" DockPanel.Dock="Top" Height="20" VerticalAlignment="Top" Margin="0,0,-10,0" HorizontalAlignment="Left" Width="auto"  Background="Transparent">
                <Menu.Style>
                    <Style>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                <Setter Property="ItemsControl.Foreground" Value="LightGray"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Menu.Style>

                <MenuItem Header="{Binding UserName}"  VerticalAlignment="Top" Height="20" HorizontalAlignment="Center">
                    <MenuItem Header="{Binding menuLogOut}" Click="btnDisconnect_Click" Foreground="Black" />
                    <Separator Margin="10"/>
                    <MenuItem Header="_Quitter" Click="btnX_Click" Foreground="Black" />
                </MenuItem>
                <MenuItem Header="_Options" Height="20">
                    <MenuItem Header="_Activer Dark Theme" IsCheckable="True" IsChecked="{Binding settings.DarkMode}" Foreground="Black"/>
                    <Separator/>
                    <MenuItem Header="_Administration ..." Visibility="{Binding admin}" Foreground="Black" Click="MenuItem_Click"/>
                    <Separator Visibility="{Binding admin}"/>
                    <MenuItem Header="_Changer de mot de passe ..." Click="changePassword_Click" Foreground="Black"/>
                    <Separator Visibility="{Binding rapport}"/>
                    <MenuItem x:Name="ctx_Rapport" Header="_Sauvegarder Rapport Excel ..." Visibility="{Binding rapport}" Foreground="Black" Click="ctx_Rapport_Click"/>
                </MenuItem>
                <MenuItem Header="_Logs" Click="Logs_Window" Visibility="{Binding admin}"/>
                <MenuItem Header="_Aide" Click="ctx_Aide"/>
                <MenuItem Header="_À propos" Click="About_Window"/>
            </Menu>
            <TextBox AcceptsReturn="True" Margin="0,0,0,1000" HorizontalAlignment="Left" VerticalAlignment="Top" />
        </DockPanel>

        <Button x:Name="bntX" Content="X" Margin="0,8,8,0" VerticalAlignment="Top" BorderBrush="{x:Null}"  Width="25" Height="25" Click="btnX_Click" HorizontalAlignment="Right">
            <Button.Style>
                <Style TargetType="{x:Type Button}">
                    <Setter Property="Background" Value="#FFC74040"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type Button}">
                                <Border Background="{TemplateBinding Background}" CornerRadius="15">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="#FFBF5555"/>
                            <Setter Property="Foreground" Value="LightGray"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Background" Value="#FFE28C8C"/>
                            <Setter Property="Foreground" Value="Gray"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Button.Style>
        </Button>

        <Button x:Name="minimize" Content="_" Margin="0,8,78,0" VerticalAlignment="Top" BorderBrush="{x:Null}"  Width="25" Height="25" Click="minimize_Click" HorizontalAlignment="Right" RenderTransformOrigin="0.5,0.5" >
            <Button.Style>
                <Style TargetType="{x:Type Button}">
                    <Setter Property="Background" Value="DarkGray"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type Button}">
                                <Border Background="{TemplateBinding Background}" CornerRadius="15">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="LightGray"/>
                            <Setter Property="Foreground" Value="Gray"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Background" Value="#FFD6D6D6"/>
                            <Setter Property="Foreground" Value="DarkGray"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Button.Style>
        </Button>

        <Button x:Name="maximize" Content="☐" Margin="0,8,43,0" VerticalAlignment="Top" BorderBrush="{x:Null}"  Width="25" Height="25" Click="maximize_Click" HorizontalAlignment="Right">
            <Button.Style>
                <Style TargetType="{x:Type Button}">
                    <Setter Property="Background" Value="DarkGray"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type Button}">
                                <Border Background="{TemplateBinding Background}" CornerRadius="15">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="LightGray"/>
                            <Setter Property="Foreground" Value="Gray"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Background" Value="#FFD6D6D6"/>
                            <Setter Property="Foreground" Value="DarkGray"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Button.Style>
        </Button>

        <TextBlock Text="Sobeys" Margin="0,10,108,0" Height="46" FontSize="36" Foreground="DarkOrange" VerticalAlignment="Top" HorizontalAlignment="Right" Width="120">
            <TextBlock.Style>
                <Style>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                            <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </TextBlock.Style>
        </TextBlock>


        <TabControl x:Name="tabControl" Margin="0,38,0,0" BorderThickness="0,1,0,0" BorderBrush="DimGray" SelectedIndex="-1" Loaded="tabControl_Loaded">

            <TabControl.Style>
                <Style>
                    <Setter Property="ItemsControl.Background" Value="#FFC5C5C5"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                            <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                            <Setter Property="ItemsControl.Background" Value="#FF343434"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </TabControl.Style>



            <TabControl.Resources>
                <Style TargetType="{x:Type Border}">
                    <Setter Property="CornerRadius" Value="10,10,10,10"/>
                </Style>



                <Style TargetType="{x:Type TabItem}">

                    <Setter Property="Template">
                        <Setter.Value>

                            <ControlTemplate TargetType="{x:Type TabItem}">

                                <Grid x:Name="Panel">
                                    <Border x:Name="Border" Background="#FFC5C5C5" BorderBrush="DimGray" BorderThickness="1,1,1,0" >
                                        <ContentPresenter VerticalAlignment="Center" Margin="5" HorizontalAlignment="Center" ContentSource="Header" >
                                        </ContentPresenter>
                                    </Border>
                                </Grid>

                                <ControlTemplate.Triggers>

                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding settings.DarkMode}" Value="true"/>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="true"/>
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Foreground" Value="LightGray"/>
                                        <Setter TargetName="Border" Property="Background" Value="#FF343434"/>
                                    </MultiDataTrigger>


                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding settings.DarkMode}" Value="true"/>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="false"/>
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Foreground" Value="LightGray"/>
                                        <Setter TargetName="Border" Property="Background" Value="#FF292929"/>
                                    </MultiDataTrigger>

                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding settings.DarkMode}" Value="false"/>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="true"/>
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Foreground" Value="Black"/>
                                        <Setter TargetName="Border" Property="Background" Value="#FFC5C5C5"/>
                                    </MultiDataTrigger>

                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding settings.DarkMode}" Value="false"/>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="false"/>
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Foreground" Value="Black"/>
                                        <Setter TargetName="Border" Property="Background" Value="#FFEEEEEE"/>
                                    </MultiDataTrigger>

                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>


                </Style>

            </TabControl.Resources>


            <TabItem x:Name="tabEnt" FontSize="12" Width="125" Margin="8,1,-8,-1" Visibility="{Binding visEnt}">

                <TabItem.Header>
                    <Grid >
                        <TextBlock TextAlignment="Center" Text="Entrepot" FontFamily="Arial" FontSize="12" Height="18" Width="80" Margin="0,2,0,-2" />
                    </Grid>
                </TabItem.Header>

                <Grid>

                    <ListView x:Name="ListViewData" GridViewColumnHeader.Click="GridViewColumnHeader_Click" VirtualizingPanel.VirtualizationMode="Recycling" VirtualizingPanel.ScrollUnit="Pixel" ItemsSource="{Binding invPostesView}" Margin="10,10,10,182" SelectionMode="Extended" MouseLeftButtonDown="ListViewData_MouseLeftButtonDown" KeyUp="ListViewData_KeyUp" >

                        <ListView.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="ItemsControl.Background" Value="#FFECECEC"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListView.Style>

                        <ListView.Resources>
                            <ContextMenu x:Key="ItemContextMenu">
                                <MenuItem x:Name="copyAll" Header="Copier ligne(s) au complet" FontSize="12" Foreground="Black" Click="copyAll_Click" />
                                <MenuItem x:Name="copyRF" Header="Copier RF(s) de Sortie" FontSize="12" Foreground="Black" Click="copyRF_Click"/>
                                <MenuItem x:Name="copyRFretour" Header="Copier RF(s) de Retour" FontSize="12" Foreground="Black" Click="copyRFretour_Click"/>
                                <MenuItem x:Name="copySN" Header="Copier numéro(s) de série" FontSize="12" Foreground="Black" Click="copySN_Click"/>
                                <Separator Margin="0,0,0,0" Visibility="{Binding Path=DataContext.admin, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ListView}}"/>
                                <MenuItem x:Name="modify" Margin="0,5,0,5" Header="Modifier sélection(s)" FontSize="12" Foreground="Black" Visibility="{Binding Path=DataContext.admin, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ListView}}" Click="modify_Click" />
                                <Separator Margin="0,0,0,0" Visibility="{Binding Path=DataContext.admin, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ListView}}"/>
                                <MenuItem x:Name="delete" Margin="0,5,0,0" Header="Surprimer sélection(s)" FontSize="12" Foreground="Black" Visibility="{Binding Path=DataContext.admin, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ListView}}" Click="delete_Click"/>
                            </ContextMenu>

                            <Style TargetType="{x:Type GridViewColumnHeader}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type GridViewColumnHeader}">
                                            <Border BorderThickness="0,0,0,1" BorderBrush="LightGray" Background="LightSteelBlue">
                                                <TextBlock x:Name="ContentHeader" Text="{TemplateBinding Content}" Padding="5,5,5,0" Width="{TemplateBinding Width}" TextAlignment="Center" />
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="OverridesDefaultStyle" Value="True" />
                                <Setter Property="Foreground" Value="Black" />
                                <Setter Property="FontFamily" Value="Segoe UI" />
                                <Setter Property="FontSize" Value="12" />
                            </Style>

                        </ListView.Resources>

                        <ListView.View>
                            <GridView x:Name="dataGridViewReg" AllowsColumnReorder="False">

                                <GridViewColumn Header=" Type" DisplayMemberBinding="{Binding type}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Modèle" DisplayMemberBinding="{Binding model}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Numéro de série" DisplayMemberBinding="{Binding serial}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Statut" DisplayMemberBinding="{Binding statut}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" RF de Sortie" DisplayMemberBinding="{Binding RF}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Date de Sortie" DisplayMemberBinding="{Binding dateSortie}" >
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" RF de Retour" DisplayMemberBinding="{Binding RFretour}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Date de Retour" DisplayMemberBinding="{Binding dateRetour}" >
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Emplacement" DisplayMemberBinding="{Binding emplacement}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Date d'ajout" DisplayMemberBinding="{Binding dateEntry}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Date d'envoie au Lab" DisplayMemberBinding="{Binding dateEntryLab}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Date Clonage" DisplayMemberBinding="{Binding dateClone}" >
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                            </GridView>
                        </ListView.View>

                        <ListView.ItemContainerStyle>
                            <Style TargetType="{x:Type ListBoxItem}">
                                <Style.Setters>
                                    <Setter Property="Foreground" Value="black"/>
                                    <Setter Property="FontWeight" Value="Normal"/>
                                    <Setter Property="FontSize" Value="12"/>
                                    <Setter Property="ContextMenu" Value="{StaticResource ItemContextMenu}"/>
                                    <EventSetter Event="MouseDoubleClick" Handler="ListBoxItem_MouseDoubleClick"/>
                                </Style.Setters>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding xcolor}" Value="1">
                                        <Setter Property="Foreground" Value="DarkOrange"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding xcolor}" Value="2">
                                        <Setter Property="Foreground" Value="Red"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListView.ItemContainerStyle>

                    </ListView>

                    <Button x:Name="btn_Ajout" Content="Ajout de nouveaux équipement a l'inventaire" Margin="0,0,286,111" IsEnabled="{Binding enableEntrepot}" Click="btn_Ajout_Click" HorizontalAlignment="Right" Width="259" Height="28" VerticalAlignment="Bottom">
                        <Button.Style>
                            <Style TargetType="{x:Type Button}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Button}">
                                            <Border Background="{TemplateBinding Background}" CornerRadius="14">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="LightBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter Property="Background" Value="LightSkyBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="Background" Value="DarkGray"/>
                                        <Setter Property="Foreground" Value="LightGray"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <Button x:Name="btn_Sortie" Content="Sortie d'équipement" HorizontalAlignment="Right" Margin="0,0,10,73" IsEnabled="{Binding enableEntrepot}" VerticalAlignment="Bottom" Width="259" Height="28" Click="btn_Sortie_Click">
                        <Button.Style>
                            <Style TargetType="{x:Type Button}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Button}">
                                            <Border Background="{TemplateBinding Background}" CornerRadius="14">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="LightBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter Property="Background" Value="LightSkyBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="Background" Value="DarkGray"/>
                                        <Setter Property="Foreground" Value="LightGray"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <Button x:Name="btn_emplacement" Content="Changement d'emplacement" HorizontalAlignment="Right" Margin="0,0,286,73" IsEnabled="{Binding enableEntrepot}" Width="259" Click="btn_emplacement_Click" Height="28" VerticalAlignment="Bottom">
                        <Button.Style>
                            <Style TargetType="{x:Type Button}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Button}">
                                            <Border Background="{TemplateBinding Background}" CornerRadius="14">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="LightBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter Property="Background" Value="LightSkyBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="Background" Value="DarkGray"/>
                                        <Setter Property="Foreground" Value="LightGray"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <Button x:Name="btn_Retour" Content="Retour d'équipement" HorizontalAlignment="Right" Margin="0,0,287,35" IsEnabled="{Binding enableEntrepot}" Width="259" Click="btn_Retour_Click" Height="28" VerticalAlignment="Bottom">
                        <Button.Style>
                            <Style TargetType="{x:Type Button}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Button}">
                                            <Border Background="{TemplateBinding Background}" CornerRadius="14">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="LightBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter Property="Background" Value="LightSkyBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="Background" Value="DarkGray"/>
                                        <Setter Property="Foreground" Value="LightGray"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <Button x:Name="btn_way" Content="Waybills" HorizontalAlignment="Right" Margin="0,0,10,35" IsEnabled="True" Width="259" Height="28" VerticalAlignment="Bottom" Click="btn_way_Click">
                        <Button.Style>
                            <Style TargetType="{x:Type Button}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Button}">
                                            <Border Background="{TemplateBinding Background}" CornerRadius="14">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="LightBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter Property="Background" Value="LightSkyBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="Background" Value="DarkGray"/>
                                        <Setter Property="Foreground" Value="LightGray"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <Button x:Name="btn_Lab" Content="Envoyer au Lab" HorizontalAlignment="Right" Margin="0,0,10,111" IsEnabled="{Binding enableEntrepot}" VerticalAlignment="Bottom" Width="259" Height="28" Click="btn_Lab_Click">
                        <Button.Style>
                            <Style TargetType="{x:Type Button}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Button}">
                                            <Border Background="{TemplateBinding Background}" CornerRadius="14">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="LightBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter Property="Background" Value="LightSkyBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="Background" Value="DarkGray"/>
                                        <Setter Property="Foreground" Value="LightGray"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <GroupBox Margin="10,0,0,10" BorderBrush="DimGray" Height="142" VerticalAlignment="Bottom" HorizontalAlignment="Left" Width="532" BorderThickness="1.5" >
                        <GroupBox.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text=" Filtres / Recherches">
                                    <TextBlock.Style>
                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                    <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </StackPanel>
                        </GroupBox.Header>

                        <Grid>

                            <TextBlock Text="Numéro de série :" Margin="5,7,340,0" Height="19" VerticalAlignment="Top">
                                <TextBlock.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>

                            <TextBox x:Name="tb_serialSearch" Text="{Binding serialSearch, UpdateSourceTrigger=PropertyChanged}" Margin="5,24,0,0" TextWrapping="NoWrap" TextChanged="tb_serialSearch_TextChanged" HorizontalAlignment="Left" Width="96" Height="18" VerticalAlignment="Top">
                                <TextBox.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="ItemsControl.Background" Value="#FF323232"/>
                                                <Setter Property="TextBlock.Foreground" Value="White"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBox.Style>
                            </TextBox>

                            <TextBlock Text="Emplacement :" Margin="222,47,206,0" Height="19" VerticalAlignment="Top">
                                <TextBlock.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>

                            <TextBox x:Name="tb_empSearch" Text="{Binding empSearch, UpdateSourceTrigger=PropertyChanged}" Margin="222,64,0,0" TextWrapping="NoWrap" HorizontalAlignment="Left" Width="96" Height="18" VerticalAlignment="Top" TextChanged="tb_empSearch_TextChanged">
                                <TextBox.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="ItemsControl.Background" Value="#FF323232"/>
                                                <Setter Property="TextBlock.Foreground" Value="White"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBox.Style>
                            </TextBox>

                            <TextBlock Text="RF :" Margin="114,7,231,93">
                                <TextBlock.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>

                            <TextBox x:Name="tb_RFsearch" Text="{Binding rfSearch, UpdateSourceTrigger=PropertyChanged}" Margin="114,24,0,0" TextWrapping="NoWrap" HorizontalAlignment="Left" Width="96" TextChanged="tb_RFsearch_TextChanged" Height="18" VerticalAlignment="Top">
                                <TextBox.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="ItemsControl.Background" Value="#FF323232"/>
                                                <Setter Property="TextBlock.Foreground" Value="White"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBox.Style>
                            </TextBox>

                            <TextBlock Text="Type :" Margin="327,7,115,0" Height="19" VerticalAlignment="Top">
                                <TextBlock.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>

                            <ComboBox x:Name="cb_type" ItemsSource="{Binding types}" IsEnabled="true" Margin="327,24,0,0" SelectedIndex="{Binding typeSearch}" SelectedItem="{Binding selectedType}" VerticalAlignment="Top" HorizontalAlignment="Left" Width="92" SelectionChanged="cb_type_SelectionChanged"/>

                            <TextBlock Text="Modèle :" Margin="423,7,13,0" Height="19" VerticalAlignment="Top">
                                <TextBlock.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>

                            <ComboBox x:Name="cb_model" IsEnabled="False" Margin="423,24,0,0" SelectedIndex="{Binding modelSearch}" ItemsSource="{Binding modelSearchCB}" SelectedItem="{Binding modelText}" VerticalAlignment="Top" SelectionChanged="cb_model_SelectionChanged" HorizontalAlignment="Left" Width="92" />

                            <TextBlock Text="Statut :" Margin="377,51,65,49" Height="19" >
                                <TextBlock.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>

                            <ComboBox x:Name="cb_statut" IsEnabled="true" Margin="377,68,0,0" SelectedIndex="{Binding statutSearch}" VerticalAlignment="Top" HorizontalAlignment="Left" Width="92" SelectionChanged="cb_statut_SelectionChanged" >
                                <ComboBoxItem Content="Tous"/>
                                <ComboBoxItem Content="En Stock"/>
                                <ComboBoxItem Content="Réservé"/>
                                <ComboBoxItem Content="Sortie"/>
                                <ComboBoxItem Content="Cloné"/>
                                <ComboBoxItem Content="Quantum"/>
                            </ComboBox>

                            <TextBlock Text="Date clonage :" Margin="5,47,340,0" Height="19" VerticalAlignment="Top">
                                <TextBlock.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>

                            <TextBox x:Name="tb_dateClone" Text="{Binding cloneSearch, UpdateSourceTrigger=PropertyChanged}" Margin="5,64,0,0" TextWrapping="NoWrap" HorizontalAlignment="Left" Width="96" TextChanged="tb_dateClone_TextChanged" Height="18" VerticalAlignment="Top">
                                <TextBox.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="ItemsControl.Background" Value="#FF323232"/>
                                                <Setter Property="TextBlock.Foreground" Value="White"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBox.Style>
                            </TextBox>

                            <TextBlock Text="(aaaa-mm-jj)" Margin="5,80,340,0" FontSize="10" Height="20" VerticalAlignment="Top">
                                <TextBlock.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>

                            <TextBlock Text="Date de Sortie :" Margin="114,47,305,53" Height="19">
                                <TextBlock.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>

                            <TextBox x:Name="tb_dateSortie" Height="18" Text="{Binding sortieSearch, UpdateSourceTrigger=PropertyChanged}" Margin="114,64,0,0" TextWrapping="NoWrap" VerticalAlignment="Top" HorizontalAlignment="Left" Width="96" TextChanged="tb_dateSortie_TextChanged">
                                <TextBox.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="ItemsControl.Background" Value="#FF323232"/>
                                                <Setter Property="TextBlock.Foreground" Value="White"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBox.Style>
                            </TextBox>

                            <TextBlock Text="(aaaa-mm-jj)" Margin="114,80,231,0" FontSize="10" Height="20" VerticalAlignment="Top">
                                <TextBlock.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>

                            <TextBlock Text="Date d'ajout :" Margin="222,7,197,93" Height="19">
                                <TextBlock.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>

                            <TextBox x:Name="tb_dateAjout" Height="18" Text="{Binding ajoutSearch, UpdateSourceTrigger=PropertyChanged}" Margin="222,24,0,0" TextWrapping="NoWrap" VerticalAlignment="Top" HorizontalAlignment="Left" Width="96" TextChanged="tb_dateAjout_TextChanged">
                                <TextBox.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="ItemsControl.Background" Value="#FF323232"/>
                                                <Setter Property="TextBlock.Foreground" Value="White"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBox.Style>
                            </TextBox>

                            <Button x:Name="btn_Filtre" Content="Enlever les filtres" HorizontalAlignment="Center" Width="108" Click="btn_Filtre_Click" Margin="0,100,0,0" Height="19" VerticalAlignment="Top">
                                <Button.Style>
                                    <Style TargetType="{x:Type Button}">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type Button}">
                                                    <Border Background="{TemplateBinding Background}" CornerRadius="10">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="LightBlue"/>
                                                <Setter Property="Foreground" Value="black"/>
                                            </Trigger>
                                            <Trigger Property="IsPressed" Value="True">
                                                <Setter Property="Background" Value="LightSkyBlue"/>
                                                <Setter Property="Foreground" Value="black"/>
                                            </Trigger>
                                            <Trigger Property="IsEnabled" Value="False">
                                                <Setter Property="Background" Value="DarkGray"/>
                                                <Setter Property="Foreground" Value="LightGray"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>

                        </Grid>
                    </GroupBox>

                    <Label x:Name="lbl_count" Content="{Binding count}" Margin="7,0,0,157" VerticalAlignment="Bottom" Height="25" HorizontalAlignment="Left" Width="68">
                        <Label.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Label.Style>
                    </Label>

                </Grid>

            </TabItem>

            <TabItem x:Name="tabLab" FontSize="12" Width="125" Margin="7,1,-7,-1" Visibility="{Binding visLab}">

                <TabItem.Header>
                    <Grid >
                        <TextBlock TextAlignment="Center" Text="Lab Clonage" FontFamily="Arial" FontSize="12" Height="18" Width="100" Margin="0,2,0,-2" />
                    </Grid>
                </TabItem.Header>

                <Grid>


                    <Label x:Name="lbl_countLab" Content="{Binding countLab}" Margin="286,0,0,7" VerticalAlignment="Bottom" Height="25" HorizontalAlignment="Left" Width="68">
                        <Label.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Label.Style>
                    </Label>

                    <TextBlock Text="Numéro de série :" Margin="364,0,0,5" Height="18" VerticalAlignment="Bottom" HorizontalAlignment="Left" Width="96">
                        <TextBlock.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>

                    <TextBox x:Name="tb_labSN" Text="{Binding searchSNlab, UpdateSourceTrigger=PropertyChanged}" Margin="461,0,0,5" TextWrapping="NoWrap" VerticalAlignment="Bottom" HorizontalAlignment="Left" Width="140" TextChanged="tb_labSN_TextChanged">
                        <TextBox.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="ItemsControl.Background" Value="#FF323232"/>
                                        <Setter Property="TextBlock.Foreground" Value="White"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBox.Style>
                    </TextBox>

                    <TextBlock Text="Modèle :" Margin="626,0,0,5" Height="18" VerticalAlignment="Bottom" HorizontalAlignment="Left" Width="49">
                        <TextBlock.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>

                    <TextBox x:Name="tb_labMod" Text="{Binding searchMODlab, UpdateSourceTrigger=PropertyChanged}" Margin="676,0,0,5" TextWrapping="NoWrap" VerticalAlignment="Bottom" HorizontalAlignment="Left" Width="140" TextChanged="tb_labMod_TextChanged">
                        <TextBox.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="ItemsControl.Background" Value="#FF323232"/>
                                        <Setter Property="TextBlock.Foreground" Value="White"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBox.Style>
                    </TextBox>

                    <ListView x:Name="ListLab" VirtualizingPanel.VirtualizationMode="Recycling" VirtualizingPanel.ScrollUnit="Pixel" ItemsSource="{Binding invPostesViewLab}" Margin="286,10,10,28" SelectionMode="Extended"  MouseLeftButtonDown="ListLab_MouseLeftButtonDown" >

                        <ListView.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="ItemsControl.Background" Value="#FFECECEC"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListView.Style>

                        <ListView.Resources>
                            <ContextMenu x:Key="ItemContextMenu">
                                <MenuItem x:Name="copySNlab" Header="Copier le numéros de série" FontSize="12" Foreground="Black" Click="copySNlab_Click"/>
                            </ContextMenu>

                            <Style TargetType="{x:Type GridViewColumnHeader}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type GridViewColumnHeader}">
                                            <Border BorderThickness="0,0,0,1" BorderBrush="LightGray" Background="LightSteelBlue">
                                                <TextBlock x:Name="ContentHeader" Text="{TemplateBinding Content}" Padding="5,5,5,0" Width="{TemplateBinding Width}" TextAlignment="Center" />
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="OverridesDefaultStyle" Value="True" />
                                <Setter Property="Foreground" Value="Black" />
                                <Setter Property="FontFamily" Value="Segoe UI" />
                                <Setter Property="FontSize" Value="12" />
                            </Style>

                        </ListView.Resources>

                        <ListView.View>
                            <GridView AllowsColumnReorder="False">

                                <GridViewColumn Header=" Type" DisplayMemberBinding="{Binding type}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Modèle" DisplayMemberBinding="{Binding model}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Numéro de série" DisplayMemberBinding="{Binding serial}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>


                                <GridViewColumn Header=" # Actif" DisplayMemberBinding="{Binding asset}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Emplacement" DisplayMemberBinding="{Binding emplacement}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Expiration Clonage" DisplayMemberBinding="{Binding dateCloneValid}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                            </GridView>
                        </ListView.View>

                        <ListView.ItemContainerStyle>
                            <Style TargetType="{x:Type ListBoxItem}">
                                <Style.Setters>
                                    <Setter Property="Foreground" Value="black"/>
                                    <Setter Property="FontWeight" Value="Normal"/>
                                    <Setter Property="FontSize" Value="12"/>
                                    <Setter Property="ContextMenu" Value="{StaticResource ItemContextMenu}"/>
                                </Style.Setters>

                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding xcolor}" Value="1">
                                        <Setter Property="Foreground" Value="DarkOrange"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding xcolor}" Value="2">
                                        <Setter Property="Foreground" Value="Red"/>
                                    </DataTrigger>
                                </Style.Triggers>

                            </Style>

                        </ListView.ItemContainerStyle>

                    </ListView>

                    <GroupBox Margin="10,10,0,10" BorderBrush="DimGray" HorizontalAlignment="Left" Width="266" BorderThickness="1.5" >
                        <GroupBox.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text=" Validation Clonage">
                                    <TextBlock.Style>
                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                    <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </StackPanel>
                        </GroupBox.Header>

                        <Grid>

                            <Label x:Name="lbl_countLabErreur" Content="{Binding countAddLab}" Margin="151,10,35,0" HorizontalContentAlignment="Right" VerticalContentAlignment="Bottom" FontSize="14" VerticalAlignment="Top" Height="26">
                                <Label.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Label.Style>
                            </Label>

                            <Label x:Name="cloneLab" Content="Numéro de série :" HorizontalAlignment="Left" VerticalAlignment="Top" Width="116" Margin="30,10,0,0">
                                <Label.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                                <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Label.Style>
                            </Label>

                            <TextBox x:Name="tb_serialLab" VerticalScrollBarVisibility="Auto" Margin="0,36,0,97" TextWrapping="Wrap" IsEnabled="{Binding enableLab}" AcceptsReturn="True" HorizontalAlignment="Center" Width="184" TextChanged="tb_serialLab_TextChanged" Loaded="tb_serialLab_Loaded">
                                <TextBox.Style>
                                    <Style TargetType="TextBox">
                                        <Setter Property="Background" Value="White"/>
                                        <Setter Property="Foreground" Value="black"/>

                                        <Style.Triggers>
                                            <MultiDataTrigger>
                                                <MultiDataTrigger.Conditions>
                                                    <Condition Binding="{Binding settings.DarkMode}" Value="true"/>
                                                    <Condition Binding="{Binding snColor}" Value="false"/>
                                                </MultiDataTrigger.Conditions>
                                                <Setter Property="Foreground" Value="LightGray"/>
                                                <Setter Property="Background" Value="#FF323232"/>
                                            </MultiDataTrigger>

                                            <MultiDataTrigger>
                                                <MultiDataTrigger.Conditions>
                                                    <Condition Binding="{Binding settings.DarkMode}" Value="true"/>
                                                    <Condition Binding="{Binding snColor}" Value="true"/>
                                                </MultiDataTrigger.Conditions>
                                                <Setter Property="Foreground" Value="Red"/>
                                                <Setter Property="Background" Value="#FF323232"/>
                                            </MultiDataTrigger>

                                            <MultiDataTrigger>
                                                <MultiDataTrigger.Conditions>
                                                    <Condition Binding="{Binding settings.DarkMode}" Value="false"/>
                                                    <Condition Binding="{Binding snColor}" Value="true"/>
                                                </MultiDataTrigger.Conditions>
                                                <Setter Property="Foreground" Value="Red"/>
                                            </MultiDataTrigger>


                                        </Style.Triggers>
                                    </Style>
                                </TextBox.Style>
                            </TextBox>

                            <TextBox x:Name="tb_erreur" HorizontalAlignment="Center" Margin="0,0,0,33" Visibility="Visible" IsReadOnly="True" Foreground="Red" Background="Transparent" TextWrapping="Wrap" BorderThickness="0" VerticalScrollBarVisibility="Auto" Width="254" Height="64" VerticalAlignment="Bottom"/>

                            <Button x:Name="btn_LabClone" Content="Clonage Validé" IsEnabled="False" HorizontalAlignment="Center" Width="102" Click="btn_LabClone_Click" Height="28" VerticalAlignment="Bottom">
                                <Button.Style>
                                    <Style TargetType="{x:Type Button}">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type Button}">
                                                    <Border Background="{TemplateBinding Background}" CornerRadius="14">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="LightBlue"/>
                                                <Setter Property="Foreground" Value="black"/>
                                            </Trigger>
                                            <Trigger Property="IsPressed" Value="True">
                                                <Setter Property="Background" Value="LightSkyBlue"/>
                                                <Setter Property="Foreground" Value="black"/>
                                            </Trigger>
                                            <Trigger Property="IsEnabled" Value="False">
                                                <Setter Property="Background" Value="DarkGray"/>
                                                <Setter Property="Foreground" Value="LightGray"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>

                        </Grid>
                    </GroupBox>

                </Grid>
            </TabItem>

            <TabItem x:Name="tabValid" FontSize="12" Width="125" Margin="4,1,-4,-1">

                <TabItem.Header>
                    <Grid >
                        <TextBlock TextAlignment="Center" Text="Validation Entrepot" FontFamily="Arial" FontSize="12" Height="18" Width="auto" Margin="0,2,0,-2" />
                    </Grid>
                </TabItem.Header>

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="318*"/>
                        <RowDefinition Height="84*"/>
                        <RowDefinition Height="221*"/>
                    </Grid.RowDefinitions>

                    <Button x:Name="btn_rapportValid" Content="Rapport" HorizontalAlignment="Left" Margin="195,0,0,10" Width="65" Height="20" VerticalAlignment="Bottom" Grid.Row="2" Click="btn_rapportValid_Click">
                        <Button.Style>
                            <Style TargetType="{x:Type Button}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Button}">
                                            <Border Background="{TemplateBinding Background}" CornerRadius="10">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="LightBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter Property="Background" Value="LightSkyBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="Background" Value="DarkGray"/>
                                        <Setter Property="Foreground" Value="LightGray"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <CheckBox x:Name="chk_special" IsEnabled="True" Content="Recherche par modèle" HorizontalAlignment="Left" Margin="10,10,0,0" VerticalAlignment="Top" Checked="chk_special_Checked" Unchecked="chk_special_Unchecked">
                        <CheckBox.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </CheckBox.Style>
                    </CheckBox>

                    <TextBlock Text="Type :" Margin="165,31,0,0" Height="18" VerticalAlignment="Top" HorizontalAlignment="Left" Width="45">
                        <TextBlock.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>

                    <ComboBox x:Name="cb_specialType" ItemsSource="{Binding validTypes}" IsEnabled="False" Margin="165,49,0,0" VerticalAlignment="Top" HorizontalAlignment="Left" Width="125" SelectionChanged="cb_specialType_SelectionChanged"/>

                    <TextBlock Text="Modèle(s) à filtrer :" Margin="165,159,0,0" Height="18" VerticalAlignment="Top" HorizontalAlignment="Left" Width="109">
                        <TextBlock.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>

                    <TextBlock Text="Modèle :" Margin="165,80,0,0" Height="18" VerticalAlignment="Top" HorizontalAlignment="Left" Width="50">
                        <TextBlock.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>

                    <ComboBox x:Name="cb_specialModel" IsEnabled="False" Margin="165,98,0,0" ItemsSource="{Binding validModel}" VerticalAlignment="Top" HorizontalAlignment="Left" Width="125" SelectionChanged="cb_specialModel_SelectionChanged" />

                    <Button x:Name="btn_addValid" IsEnabled="False" Content="Ajouter" HorizontalAlignment="Left" Width="125" Margin="165,125,0,0" Height="19" VerticalAlignment="Top" Click="btn_addValid_Click">
                        <Button.Style>
                            <Style TargetType="{x:Type Button}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Button}">
                                            <Border Background="{TemplateBinding Background}" CornerRadius="10">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="LightBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter Property="Background" Value="LightSkyBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="Background" Value="DarkGray"/>
                                        <Setter Property="Foreground" Value="LightGray"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <ListBox x:Name="listValid" Margin="165,177,0,7" SelectionMode="Single" ItemsSource="{Binding validList}" HorizontalAlignment="Left" Width="125" MouseLeftButtonDown="listModel_MouseLeftButtonDown" >

                        <ListBox.Resources>
                            <ContextMenu x:Key="ItemContextMenu">
                                <MenuItem x:Name="ctx_enleverModel" Header="Enlever ce modèle" FontSize="12" Foreground="Black" Click="ctx_enleverModel_Click"/>
                            </ContextMenu>
                        </ListBox.Resources>

                        <ListBox.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="ItemsControl.Background" Value="#FF323232"/>
                                        <Setter Property="TextBlock.Foreground" Value="White"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListBox.Style>

                        <ListBox.ItemContainerStyle>
                            <Style TargetType="{x:Type ListBoxItem}">
                                <Setter Property="ContextMenu" Value="{StaticResource ItemContextMenu}"/>
                            </Style>
                        </ListBox.ItemContainerStyle>

                    </ListBox>

                    <Button x:Name="btn_validClear" IsEnabled="False" Content="Effacer les modèles" HorizontalAlignment="Left" Width="125" Margin="165,1,0,0" Height="19" VerticalAlignment="Top" Click="btn_validClear_Click" Grid.Row="1">
                        <Button.Style>
                            <Style TargetType="{x:Type Button}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Button}">
                                            <Border Background="{TemplateBinding Background}" CornerRadius="10">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="LightBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter Property="Background" Value="LightSkyBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="Background" Value="DarkGray"/>
                                        <Setter Property="Foreground" Value="LightGray"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <TextBlock Text="Numéros de série :" Margin="10,31,0,0" Height="18" VerticalAlignment="Top" HorizontalAlignment="Left" Width="101">
                        <TextBlock.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>

                    <TextBox x:Name="tb_valid" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" Margin="10,48,0,40" TextWrapping="NoWrap" AcceptsReturn="True" HorizontalAlignment="Left" Width="150" TextChanged="tb_valid_TextChanged" Grid.RowSpan="2">
                        <TextBox.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="ItemsControl.Background" Value="#FF323232"/>
                                        <Setter Property="TextBlock.Foreground" Value="White"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBox.Style>
                    </TextBox>

                    <Button x:Name="btn_Valid" IsEnabled="False" Content="Recherche" HorizontalAlignment="Left" Margin="10,0,0,7" VerticalAlignment="Bottom" Width="150" Height="28" Click="btn_Valid_Click" Grid.Row="1">
                        <Button.Style>
                            <Style TargetType="{x:Type Button}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Button}">
                                            <Border Background="{TemplateBinding Background}" CornerRadius="14">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="LightBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter Property="Background" Value="LightSkyBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="Background" Value="DarkGray"/>
                                        <Setter Property="Foreground" Value="LightGray"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <TextBlock Text="Pas dans l'inventaire :" Margin="10,13,0,0" Height="18" VerticalAlignment="Top" HorizontalAlignment="Left" Width="112" Grid.Row="2">
                        <TextBlock.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>

                    <Label x:Name="lbl_countValidPasTrouver"  Margin="128,9,0,0" VerticalAlignment="Top" HorizontalContentAlignment="Right" Height="24" HorizontalAlignment="Left" Width="32" Grid.Row="2">
                        <Label.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Label.Style>
                    </Label>

                    <ListBox x:Name="listErreur" Margin="10,31,0,10" SelectionMode="Extended" HorizontalAlignment="Left" Width="150" MouseLeftButtonDown="ListViewData_MouseLeftButtonDown" Grid.Row="2" >

                        <ListBox.Resources>
                            <ContextMenu x:Key="ItemContextMenu">
                                <MenuItem x:Name="copySNctx" Header="Copier numéro(s) de sériel" FontSize="12" Foreground="Black"/>
                            </ContextMenu>
                        </ListBox.Resources>

                        <ListBox.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="ItemsControl.Background" Value="#FF323232"/>
                                        <Setter Property="TextBlock.Foreground" Value="White"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListBox.Style>

                        <ListBox.ItemContainerStyle>
                            <Style TargetType="{x:Type ListBoxItem}">
                                <Setter Property="ContextMenu" Value="{StaticResource ItemContextMenu}"/>
                            </Style>
                        </ListBox.ItemContainerStyle>

                    </ListBox>

                    <Label x:Name="lbl_countTrouver" HorizontalContentAlignment="Right" Margin="0,24,10,0" VerticalAlignment="Top" Height="24" HorizontalAlignment="Right" Width="68">
                        <Label.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Label.Style>
                    </Label>

                    <Label x:Name="lbl_countValid"  Margin="116,25,0,0" VerticalAlignment="Top" HorizontalContentAlignment="Right" Height="24" HorizontalAlignment="Left" Width="44">
                        <Label.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Label.Style>
                    </Label>

                    <TextBlock Text="Résultats :" Margin="295,31,0,0" Height="18" VerticalAlignment="Top" HorizontalAlignment="Left" Width="56">
                        <TextBlock.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>

                    <Button x:Name="btn_clearValid" Content="Effacer tous" Margin="0,5,10,0" Height="20" VerticalAlignment="Top" Click="btn_clearValid_Click" HorizontalAlignment="Right" Width="78">
                        <Button.Style>
                            <Style TargetType="{x:Type Button}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Button}">
                                            <Border Background="{TemplateBinding Background}" CornerRadius="10">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="LightBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter Property="Background" Value="LightSkyBlue"/>
                                        <Setter Property="Foreground" Value="black"/>
                                    </Trigger>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="Background" Value="DarkGray"/>
                                        <Setter Property="Foreground" Value="LightGray"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <ListView x:Name="ViewValidStock" GridViewColumnHeader.Click="GridViewColumnHeader_Click" VirtualizingPanel.VirtualizationMode="Recycling" VirtualizingPanel.ScrollUnit="Pixel" Margin="295,49,10,7" SelectionMode="Extended" MouseLeftButtonDown="ListViewData_MouseLeftButtonDown" KeyUp="ListViewData_KeyUp" >

                        <ListView.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="ItemsControl.Background" Value="#FFECECEC"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListView.Style>

                        <ListView.Resources>
                            <ContextMenu x:Key="ItemContextMenu">
                                <MenuItem x:Name="copyAllV" Header="Copier ligne(s) au complet" FontSize="12" Foreground="Black" Click="copyAllV_Click" />
                                <MenuItem x:Name="copyRFv" Header="Copier RF(s) de Sortie" FontSize="12" Foreground="Black" Click="copyRFv_Click"/>
                                <MenuItem x:Name="copyRFretourV" Header="Copier RF(s) de Retour" FontSize="12" Foreground="Black" Click="copyRFretourV_Click"/>
                                <MenuItem x:Name="copySNv" Header="Copier numéro(s) de série" FontSize="12" Foreground="Black" Click="copySNv_Click"/>
                            </ContextMenu>

                            <Style TargetType="{x:Type GridViewColumnHeader}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type GridViewColumnHeader}">
                                            <Border BorderThickness="0,0,0,1" BorderBrush="LightGray" Background="LightSteelBlue">
                                                <TextBlock x:Name="ContentHeader" Text="{TemplateBinding Content}" Padding="5,5,5,0" Width="{TemplateBinding Width}" TextAlignment="Center" />
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="OverridesDefaultStyle" Value="True" />
                                <Setter Property="Foreground" Value="Black" />
                                <Setter Property="FontFamily" Value="Segoe UI" />
                                <Setter Property="FontSize" Value="12" />
                            </Style>

                        </ListView.Resources>

                        <ListView.View>
                            <GridView x:Name="dataGridViewRegV" AllowsColumnReorder="False">

                                <GridViewColumn Header=" Type" DisplayMemberBinding="{Binding type}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Modèle" DisplayMemberBinding="{Binding model}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" # Actif" DisplayMemberBinding="{Binding asset}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Numéro de série" DisplayMemberBinding="{Binding serial}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Statut" DisplayMemberBinding="{Binding statut}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" RF de Sortie" DisplayMemberBinding="{Binding RF}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Date de Sortie" DisplayMemberBinding="{Binding dateSortie}" >
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" RF de Retour" DisplayMemberBinding="{Binding RFretour}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Date de Retour" DisplayMemberBinding="{Binding dateRetour}" >
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Emplacement" DisplayMemberBinding="{Binding emplacement}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Date d'ajout" DisplayMemberBinding="{Binding dateEntry}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Date d'envoie au Lab" DisplayMemberBinding="{Binding dateEntryLab}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Date Clonage" DisplayMemberBinding="{Binding dateClone}" >
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Expiration Clonage" DisplayMemberBinding="{Binding dateCloneValid}" >
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                            </GridView>
                        </ListView.View>

                        <ListView.ItemContainerStyle>
                            <Style TargetType="{x:Type ListBoxItem}">
                                <Style.Setters>
                                    <Setter Property="Foreground" Value="black"/>
                                    <Setter Property="FontWeight" Value="Normal"/>
                                    <Setter Property="FontSize" Value="12"/>
                                    <Setter Property="ContextMenu" Value="{StaticResource ItemContextMenu}"/>
                                    <EventSetter Event="MouseDoubleClick" Handler="ListBoxItem_MouseDoubleClick"/>
                                </Style.Setters>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding xcolor}" Value="1">
                                        <Setter Property="Foreground" Value="DarkOrange"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding xcolor}" Value="2">
                                        <Setter Property="Foreground" Value="Red"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListView.ItemContainerStyle>

                    </ListView>

                    <Label x:Name="lbl_countPasTrouver" HorizontalContentAlignment="Right" Margin="0,3,10,0" VerticalAlignment="Top" Height="25" HorizontalAlignment="Right" Width="68" Grid.Row="1">
                        <Label.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Label.Style>
                    </Label>

                    <TextBlock Text="Modèles dans l'inventaire autre que les S/N de recherche (si 'Recherche par modèle' sélectionné) :" Margin="295,11,0,0" Height="18" VerticalAlignment="Top" HorizontalAlignment="Left" Width="523" Grid.Row="1">
                        <TextBlock.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="TextBlock.Foreground" Value="LightGray"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>

                    <ListView x:Name="ViewValidSortie" IsEnabled="False" GridViewColumnHeader.Click="GridViewColumnHeader_Click" VirtualizingPanel.VirtualizationMode="Recycling" VirtualizingPanel.ScrollUnit="Pixel" Margin="295,28,10,10" SelectionMode="Extended" MouseLeftButtonDown="ListViewData_MouseLeftButtonDown" KeyUp="ListViewData_KeyUp" Grid.RowSpan="2" Grid.Row="1" >

                        <ListView.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding settings.DarkMode}" Value="true">
                                        <Setter Property="ItemsControl.Background" Value="#FFECECEC"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListView.Style>

                        <ListView.Resources>
                            <ContextMenu x:Key="ItemContextMenu">
                                <MenuItem x:Name="copyAllVs" Header="Copier ligne(s) au complet" FontSize="12" Foreground="Black" Click="copyAllVs_Click" />
                                <MenuItem x:Name="copyRFvs" Header="Copier RF(s) de Sortie" FontSize="12" Foreground="Black" Click="copyRFvs_Click"/>
                                <MenuItem x:Name="copyRFretourVs" Header="Copier RF(s) de Retour" FontSize="12" Foreground="Black" Click="copyRFretourVs_Click"/>
                                <MenuItem x:Name="copySNvs" Header="Copier numéro(s) de série" FontSize="12" Foreground="Black" Click="copySNvs_Click"/>
                            </ContextMenu>

                            <Style TargetType="{x:Type GridViewColumnHeader}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type GridViewColumnHeader}">
                                            <Border BorderThickness="0,0,0,1" BorderBrush="LightGray" Background="LightSteelBlue">
                                                <TextBlock x:Name="ContentHeader" Text="{TemplateBinding Content}" Padding="5,5,5,0" Width="{TemplateBinding Width}" TextAlignment="Center" />
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="OverridesDefaultStyle" Value="True" />
                                <Setter Property="Foreground" Value="Black" />
                                <Setter Property="FontFamily" Value="Segoe UI" />
                                <Setter Property="FontSize" Value="12" />
                            </Style>

                        </ListView.Resources>

                        <ListView.View>
                            <GridView x:Name="dataGridViewRegVs" AllowsColumnReorder="False">

                                <GridViewColumn Header=" Type" DisplayMemberBinding="{Binding type}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Modèle" DisplayMemberBinding="{Binding model}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" # Actif" DisplayMemberBinding="{Binding asset}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Numéro de série" DisplayMemberBinding="{Binding serial}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Statut" DisplayMemberBinding="{Binding statut}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" RF de Sortie" DisplayMemberBinding="{Binding RF}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Date de Sortie" DisplayMemberBinding="{Binding dateSortie}" >
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" RF de Retour" DisplayMemberBinding="{Binding RFretour}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Date de Retour" DisplayMemberBinding="{Binding dateRetour}" >
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Emplacement" DisplayMemberBinding="{Binding emplacement}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Date d'ajout" DisplayMemberBinding="{Binding dateEntry}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Date d'envoie au Lab" DisplayMemberBinding="{Binding dateEntryLab}">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Date Clonage" DisplayMemberBinding="{Binding dateClone}" >
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                                <GridViewColumn Header=" Expiration Clonage" DisplayMemberBinding="{Binding dateCloneValid}" >
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="Normal"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Background" Value="LightSteelBlue"/>
                                            <Setter Property="BorderBrush" Value="LightGray"/>
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                </GridViewColumn>

                            </GridView>
                        </ListView.View>

                        <ListView.ItemContainerStyle>
                            <Style TargetType="{x:Type ListBoxItem}">
                                <Style.Setters>
                                    <Setter Property="Foreground" Value="black"/>
                                    <Setter Property="FontWeight" Value="Normal"/>
                                    <Setter Property="FontSize" Value="12"/>
                                    <Setter Property="ContextMenu" Value="{StaticResource ItemContextMenu}"/>
                                    <EventSetter Event="MouseDoubleClick" Handler="ListBoxItem_MouseDoubleClick"/>
                                </Style.Setters>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding xcolor}" Value="1">
                                        <Setter Property="Foreground" Value="DarkOrange"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding xcolor}" Value="2">
                                        <Setter Property="Foreground" Value="Red"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListView.ItemContainerStyle>

                    </ListView>

                </Grid>
            </TabItem>

        </TabControl>




    </Grid>

    <Window.Resources>
        <Style TargetType="{x:Type Border}">
            <Setter Property="CornerRadius" Value="10"/>
        </Style>

        <BorderGapMaskConverter x:Key="BorderGapMaskConverter"/>
        <Style TargetType="{x:Type GroupBox}">
            <Setter Property="BorderBrush" Value="#D5DFE5" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type GroupBox}">
                        <Grid SnapsToDevicePixels="true">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="6" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="6" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="6" />
                            </Grid.RowDefinitions>
                            <Border CornerRadius="4" Grid.Row="1" Grid.RowSpan="3" Grid.Column="0" Grid.ColumnSpan="4" BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="Transparent" Background="{TemplateBinding Background}" />
                            <Border Name="Header" Padding="3,1,3,0" Grid.Row="0" Grid.RowSpan="2" Grid.Column="1">
                                <ContentPresenter ContentSource="Header" RecognizesAccessKey="true" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                            <ContentPresenter Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2" Margin="{TemplateBinding Padding}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            <Border Grid.Row="1" Grid.RowSpan="3" Grid.ColumnSpan="4"  BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}" CornerRadius="3">
                                <Border.OpacityMask>
                                    <MultiBinding Converter="{StaticResource BorderGapMaskConverter}" ConverterParameter="7">
                                        <Binding ElementName="Header" Path="ActualWidth" />
                                        <Binding Path="ActualWidth" RelativeSource="{RelativeSource Self}" />
                                        <Binding Path="ActualHeight" RelativeSource="{RelativeSource Self}" />
                                    </MultiBinding>
                                </Border.OpacityMask>
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </Window.Resources>

    <WindowChrome.WindowChrome>
        <WindowChrome GlassFrameThickness="0" CornerRadius="20" CaptionHeight="0" UseAeroCaptionButtons="False" ResizeBorderThickness="10"/>
    </WindowChrome.WindowChrome>

</Window>
